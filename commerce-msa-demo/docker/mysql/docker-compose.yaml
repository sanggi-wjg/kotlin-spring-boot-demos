name: commerce-msa-demo

services:
  product-service-mysql:
    image: mysql:8.0
    container_name: product-service-mysql
    ports:
      - "8010:3306"
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=true
      - MYSQL_DATABASE=msa_product
      - MYSQL_USER=general_user
      - MYSQL_PASSWORD=passw0rd
    volumes:
      - ./config/my.cnf:/etc/mysql/conf.d/my.cnf:ro
      - ./config/product-service-init.sql:/docker-entrypoint-initdb.d/init.sql:ro
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 512M

  order-service-mysql:
    image: mysql:8.0
    container_name: order-service-mysql
    ports:
      - "8011:3306"
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=true
      - MYSQL_DATABASE=msa_order
      - MYSQL_USER=general_user
      - MYSQL_PASSWORD=passw0rd
    volumes:
      - ./config/my.cnf:/etc/mysql/conf.d/my.cnf:ro
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 512M

  user-service-mysql:
    image: mysql:8.0
    container_name: user-service-mysql
    ports:
      - "8012:3306"
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=true
      - MYSQL_DATABASE=msa_user
      - MYSQL_USER=general_user
      - MYSQL_PASSWORD=passw0rd
    volumes:
      - ./config/my.cnf:/etc/mysql/conf.d/my.cnf:ro
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 512M
